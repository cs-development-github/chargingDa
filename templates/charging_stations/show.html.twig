{% extends 'base.html.twig' %}

{% block title %}Détails de la borne - {{ station.model }}{% endblock %}

{% block body %}
<style>
    .station-card {
        border-radius: 10px;
        box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
        background-color: #fff;
        padding: 20px;
        margin-top: 90px;
    }

    .station-card h4 {
        font-weight: bold;
        text-transform: uppercase;
    }

    .modal-content {
        border-radius: 12px;
        box-shadow: rgba(0, 0, 0, 0.2) 0px 10px 30px;
        border: none;
    }

    .modal-header {
        background: linear-gradient(to right, #ff4081, #ff8c00);
        color: white;
        border-top-left-radius: 12px;
        border-top-right-radius: 12px;
    }

    .btn-close {
        filter: invert(1);
    }

    .btn-save {
        background: linear-gradient(to right, #ff4081, #ff8c00);
        border-radius: 10px;
        color: white;
        border: none;
        padding: 10px 20px;
    }
</style>

<div class="container">
    <div class="station-card">
        <h4 class="text-center mb-4">Détails de la borne</h4>
        <div class="row">
            <div class="col-md-6 mb-3">
                <p class="fw-bold mb-1">Modèle</p>
                <p class="text-dark">{{ station.model }}</p>
            </div>

            <div class="col-md-6 mb-3">
                <p class="fw-bold mb-1">Fabricant</p>
                <p class="text-dark">
                    {{ station.manufacturer.name }}
                </p>
            </div>

            <div class="col-md-6 mb-3">
                <p class="fw-bold mb-1">PDC</p>
                <p class="text-dark">{{ station.connectors }}</p>
            </div>

            <div class="col-md-6 mb-3">
                <p class="fw-bold mb-1">Logo Fabricant</p>
                {% if station.manufacturer.image %}
                <img src="{{ asset('uploads/' ~ station.manufacturer.image) }}" alt="Logo Fabricant" width="120"
                    style="border-radius: 8px;">
                {% else %}
                <span class="text-muted">Non disponible</span>
                {% endif %}
            </div>

            <div class="col-md-6 mb-3">
                <p class="fw-bold mb-1">Photo</p>
                {% if station.image %}
                <img src="{{ asset('uploads/' ~ station.image) }}" alt="Image Borne" width="120"
                    style="border-radius: 8px;">
                {% else %}
                <span class="text-muted">Non disponible</span>
                {% endif %}
            </div>
        </div>

        {% if is_granted('ROLE_ADMIN') %}
        <div class="d-flex justify-content-center gap-3 mt-4">
            <button class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#editStationModal">
                Modifier la borne
            </button>
            <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteStationModal">
                Supprimer la borne
            </button>
        </div>
        {% endif %}
    </div>
</div>

{% if is_granted('ROLE_ADMIN') %}
<div class="modal fade" id="editStationModal" tabindex="-1" aria-labelledby="editStationModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editStationModalLabel">Modifier la borne</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
            </div>
            <div class="modal-body">
                <form action="{{ path('charging_station_edit', { slug: station.slug }) }}" method="POST"
                    enctype="multipart/form-data">
                    {{ form_start(editForm) }}

                    <div class="mb-3">
                        {{ form_label(editForm.model, 'Modèle', {'label_attr': {'class': 'fw-bold'}}) }}
                        {{ form_widget(editForm.model, {'attr': {'class': 'form-control'}}) }}
                    </div>

                    <div class="mb-3">
                        {{ form_label(editForm.manufacturer, 'Fabricant', {'label_attr': {'class': 'fw-bold'}}) }}
                        {{ form_widget(editForm.manufacturer, {'attr': {'class': 'form-control'}}) }}
                    </div>

                    <div class="mb-3">
                        {{ form_label(editForm.connectors, 'PDC', {'label_attr': {'class': 'fw-bold'}}) }}
                        {{ form_widget(editForm.connectors, {'attr': {'class': 'form-control'}}) }}
                    </div>

                    <div class="mb-3">
                        <label class="fw-bold">Nouvelle Image de la Borne</label>
                        <input type="file" name="image" class="form-control">
                    </div>

                    <div class="modal-footer">
                        <button type="submit" class="btn btn-save">Enregistrer les modifications</button>
                    </div>

                    {{ form_end(editForm) }}
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="deleteStationModal" tabindex="-1" aria-labelledby="deleteStationModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="deleteStationModalLabel">Confirmation de suppression</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
            </div>
            <div class="modal-body">
                <p>Êtes-vous sûr de vouloir supprimer cette borne ? Cette action est irréversible.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                <form action="{{ path('charging_station_delete', { slug: station.slug }) }}" method="POST">
                    <button type="submit" class="btn btn-danger">Confirmer la suppression</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}